var page_data={},url,$curtain=$('.black-curtain-in'),$page=$('#loaded-page'),projects={about:{image:'',page:'about.html',pageTitle:'TYLER WATSON | about'},'mv agusta':{image_id:'_mv',page:'mvagusta.html',pageTitle:'TYLER WATSON | MV Agusta'},'air & space':{image_id:'_air',page:'air&space.html',pageTitle:'TYLER WATSON | Air & Space'},'motion reel':{image_id:'_reel',page:'reel.html',pageTitle:'TYLER WATSON | Motion Reel'},panopticon:{image_id:'_panopticon',page:'panopticon.html',pageTitle:'TYLER WATSON | Panopticon'},Ã¦olia:{image_id:'_aeolia',page:'aeolia.html',pageTitle:'TYLER WATSON | AEOLIA'},eet:{image_id:'_eet',page:'eet.html',pageTitle:'TYLER WATSON | EET'},'gladwell series':{image_id:'_gladwell',page:'gladwell_series.html',pageTitle:'TYLER WATSON | Gladwell Series'},arsia:{image_id:'_arsia',page:'arsia.html',pageTitle:'TYLER WATSON | Arsia'}},keys=Object.keys(projects);function setPgData(a,b){a.index=keys.indexOf(b);var c=a.index;return a.name=b,a.url=projects[keys[c]].page,a.page='/projects/'+projects[keys[c]].page,a.image_id=projects[keys[c]].image_id,a.pageTitle=projects[keys[c]].pageTitle,(a,keys)}function updatePage_index(a,b){return b.index=a,name=keys[a],b.name=name,b}function returnImageID(a,b){var c=Object.keys(projects),d=c.indexOf(b);return a.image_id=projects[c[d]].image_id,a}function getNextProject_data(a,b){var c=a.index,d=b.length-1;return c=a.index==d?1:a.index+1,$('.status-current').prepend(a.index),$('.status-length').prepend(d),next_name=b[c],void $('i.data-project').prepend(next_name)}function push_pageHistory(a,b){var c=b[a.index],d=a.pageTitle,f=a.url;f=f.replace('.html',''),history.pushState(c,d,f)}function findURL(a,b){var c=keys.indexOf(a),d='/projects/'+projects[keys[c]].page;return updatePage_index(c,b),void loadProject(d)}function renderPopState(){window.addEventListener('popstate',function(a){return''==a.state||''===a.state.id?void curtainClose():history.state===a.state?void findURL(a.state,page_data):a.state},!1)}function closeProject(){curtainClose()}function returnDirection_val(a){var b=1.65*$(window).height();return'up'==a&&(a='-'+b),'down'==a&&(a=b),a}function resetCurtain(a){return new Promise(b=>{a.css({top:'120vh'}),b()})}function animCurtain(a,b){return a=returnDirection_val(a),b.animate({top:'+='+a},350,function(){}).promise()}var loadPage=function(a,b,c,d){return new Promise(f=>{$.ajax(c,{success:function(h){return ga('send',{hitType:'pageview',page:c}),d=h,f(d)}})})},curtainUp=function(){return new Promise(a=>{resetCurtain($curtain).then(()=>{a(animCurtain('up',$curtain))})})},curtainClose=function(){animCurtain('down',$curtain).then(()=>{emptyPage()}).then(()=>{setTimeout(function(){animCurtain('down',$curtain)},200)})},emptyPage=function(){return new Promise(a=>{$('#loaded-page').hide().empty(),a()})},appendData=function(a,b){return new Promise(c=>{a.append(b[0]).show(0,function(){getNextProject_data(page_data,keys);var g=$(this).find('.description'),h=g.outerHeight();$('.description-space').css({height:h}),$.getScript('/scripts/project.js',function(){c()})})})};function loadProject(a){Promise.all([loadPage($curtain,$page,a),curtainUp()]).then(c=>{emptyPage().then(()=>{appendData($page,c)}).then(()=>{setTimeout(function(){animCurtain('up',$curtain)},200)})})}function fadeInPreview(a){var b=$(a.target).text();returnImageID(page_data,b);var c='#'+page_data.image_id;that=$(c),that.stop(!0,!0).fadeIn(500).queue(!1)}function fadeOutPreview(a){var b=$(a.target).text();returnImageID(page_data,b);var c='#'+page_data.image_id;$(c).stop(!0,!1).fadeOut(500).queue(!1)}$(function(){function a(b){b.preventDefault();var c=$(b.target).text();return setPgData(page_data,c),push_pageHistory(page_data,keys),loadProject(page_data.page),page_data}history.replaceState('','',''),renderPopState(),$('li').on('click',a.bind(this)),$('.terminal > div p').on('click',a.bind(this)),$('li').mouseover(function(b){fadeInPreview(b)}).mouseout(function(b){fadeOutPreview(b)}),$('.space .projects').mouseover(function(){$('.page').stop(!0,!1).animate({opacity:'.85'},400,'linear')}).mouseout(function(){$('.page').stop(!0,!1).animate({opacity:'1'},400,'linear')})});
